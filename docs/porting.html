<!DOCTYPE html><html><head><title>Trial / Platform Support and Porting</title><meta property="og:image" content="https://repository-images.githubusercontent.com/54314855/81c55af6-b2c4-45f0-b66d-f29fdd37be7f"><meta property="og:image:alt" content="Trial is currently actively supported on the following platform combinations:"><meta property="og:type" content="object"><meta property="og:title" content="Trial / Platform Support and Porting"><meta property="og:url" content="https://shirakumo.org/docs/trial/porting.mess.html"><meta property="og:description" content="Trial is currently actively supported on the following platform combinations:"></head><body><article><a class="index" href="index.html">Index</a><style>article{max-width:800px;font-size:12pt;font-family:sans-serif;margin:0 auto 3em auto;}article h1{text-align:center;font-size:2em;}article img{margin:0 auto;max-width:100%;}article blockquote{border-left:0.2em solid gray;margin-left:1em;padding-left:1em;}article figcaption{padding:0.2em 1em;background:#E0E0E0;}article code{background:#F0F0F0;padding:0 0.1em;}article .code-block{padding:0.1em 0.5em;overflow-x:auto;}article a.index{display:block;text-decoration:none;text-align:center;font-size:1.1em;background:#151515;border:2px solid #151515;color:#FEFEFE;}article a.index:hover{background:#FEFEFE;color:#151515;}</style><h1 id="platform support and porting">Platform Support and Porting</h1><p>Trial is currently actively supported on the following platform combinations:</p><ul><li><p>SBCL</p><ul><li><p>Linux (AMD64, x86, ARM64)</p></li><li><p>Windows (AMD64)</p></li><li><p>Nintendo Switch (ARM64)</p></li></ul></li></ul><p>It has also been known to work (albeit perhaps suboptimally) on the following:</p><ul><li><p>SBCL</p><ul><li><p>MacOS (AMD64, ARM64)</p></li></ul></li><li><p>CCL</p><ul><li><p>Linux</p></li></ul></li><li><p>ECL</p><ul><li><p>Linux</p></li></ul></li></ul><p>Though these targets are not actively supported by the core development team. Please help out if you're interested though, patches are very much welcome! There's just currently nobody with the hardware and energy to actively support these or other systems.</p><p>On all systems Trial requires an OpenGL Core 3.3 (or higher) capable driver.</p><h2 id="porting">Porting</h2><p>In order to port Trial to other Lisp implementations or operating system environments, you'll probably have quite a bit of work ahead of yourself. For instance, any platform without OpenGL support will require an OpenGL emulation layer, and while Trial can run some simple things on OpenGL ES APIs, it has not been tested.</p><h3 id="implementations">Implementations</h3><p>When porting to a new implementation, the first order of business is to simply try loading Trial. Most likely the implementation will choke on <a class="external-link" href="https://shinmera.com/projects/3d-math">3d-math</a>, so you might need to figure out a way to make that library more amenable to being loaded on your implementation of choice. Other libraries may also need adjustments to work correctly.</p><p>Once Trial loads, you will want to run the selftest suite via</p><code style="display:block" class="code-block" data-language="common lisp"><pre>(asdf:test-system :trial-selftest)</pre></code><p>The selftest suite is designed to touch as many of the operating system and implementation interoperability bits that Trial needs as possible. It will tell you about everything that might be broken. If all tests pass, that's a huge sign!</p><p>Once that's working, you can also try loading the <a class="external-link" href="examples.html">examples</a>, which should work fine. And once those are confirmed working, the port is pretty much done, perhaps modulo performance issues.</p><h3 id="operating systems">Operating Systems</h3><p>Porting to another operating system is similar to porting to another implementation. You will want to run the selftest suite to see what's broken. You will likely need to make updates to the following libraries to ensure compliance:</p><ul><li><p><a class="external-link" href="https://shirakumo.org/projects/cl-gamepad">cl-gamepad</a></p></li><li><p><a class="external-link" href="https://shirakumo.org/projects/cl-mixed">cl-mixed</a></p></li><li><p><a class="external-link" href="https://shinmera.com/projects/file-attributes">file-attributes</a></p></li><li><p><a class="external-link" href="https://shinmera.com/projects/filesystem-utils">filesystem-utils</a></p></li><li><p><a class="external-link" href="https://shirakumo.org/projects/harmony">harmony</a></p></li><li><p><a class="external-link" href="https://shinmera.com/projects/machine-state">machine-state</a></p></li><li><p><a class="external-link" href="https://shinmera.com/projects/messagebox">messagebox</a></p></li><li><p><a class="external-link" href="https://shinmera.com/projects/open-with">open-with</a></p></li><li><p><a class="external-link" href="https://shinmera.com/projects/pathname-utils">pathname-utils</a></p></li><li><p><a class="external-link" href="https://shinmera.com/projects/precise-time">precise-time</a></p></li><li><p><a class="external-link" href="https://shinmera.com/projects/system-locale">system-locale</a></p></li></ul><h3 id="graphics apis">Graphics APIs</h3><p>As mentioned Trial is currently hard-wired for desktop OpenGL. In order to better support OpenGL ES, the primary work to be done would be in <a class="external-link" href="https://shirakumo.org/projects/glsl-toolkit">glsl-toolkit</a>, to automatically rewrite GLSL shader code to work with the slight differences between desktop GL and GLES. It is likely that some Trial bits would also need further conditionalising behind <code>when-gl-extension</code> or <code>gl-extension-case</code>.</p><p>Larger rewrites to target other graphics APIs entirely such as DirectX, Vulkan, or WebGPU are much bigger efforts and would need to happen in several stages:</p><ol><li value="1"><p>Silo all direct OpenGL calls in Trial calls such that games do not ever need to touch the <code>gl</code> or <code>%gl</code> packages.</p></li><li value="2"><p>Separate out rendering state such that no <code>enable-feature</code> or <code>disable-feature</code> or similar calls need to be made, and instead a general &quot;render state&quot; object is used that is more amenable to how more modern APIs function.</p></li><li value="3"><p>Rewrite all <code>resources</code> to be abstract classes that are implemented with subclasses by a specific API instead, and introduce a runtime switch for the used API.</p></li><li value="4"><p>Rewrite the <code>context</code> and backend implementations to provide the API information and, if possible, allow selecting the API used.</p></li><li value="5"><p>Start writing an actual backend other than OpenGL. This may also require pulling in something that can compile GLSL to a target shader language.</p></li></ol></article></body></html><link rel="stylesheet" href="highlight-lisp.css"><script type="text/javascript" src="highlight-lisp.js"></script><script type="text/javascript">[...document.querySelectorAll('[data-language="common lisp"] pre')].map(HighlightLisp.highlight_element);</script>